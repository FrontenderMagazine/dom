# Что такое DOM?

Один из читателей недавно спросил меня, что такое DOM (*русский термин 
«Объектная модель документа» употребляется немногим чаще, поэтому для краткости 
я буду использовать оригинальную аббревиатуру — прим. переводчика*). Он 
сказал, что слышал упоминания о DOM, но не уверен, что в точности понимает, что 
же это такое.

Сейчас мы во всем разберемся.

![DOM — это HTML, который я пишу? Нет. Не совсем.][Рисунок 1]

Но тот HTML-код, который вы пишете, анализируется браузером и преобразуется им  
в DOM.

![«Просмотр кода страницы» — это DOM? Нет. Не совсем.][Рисунок 2]

«Просмотр кода страницы» всего лишь показывает HTML-код, формирующий страницу. 
Это практически именно тот HTML-код, который вы написали.

Этот код может выглядеть несколько иначе, если, например, вы работаете с 
файлами шаблона на бэкенде и не очень-то часто заглядываете в HTML-код, 
получаемый на выходе. Или если перед публикацией страницы на сайте ваш HTML-код 
проходит через некоторый «рабочий процесс». Может быть, этот код сжимается 
перед публикацией или изменяется каким-либо другим способом.

В целом, «Просмотр кода страницы» — немного странная штука. На самом деле этот
код интересен только разработчикам, но в то же время все современные браузеры 
уже имеют встроенные инструменты для разработчиков (DevTools). Возможно, 
эта функция браузеров уже бесполезна.

![А код в панели разработчика — это DOM? В общем, да!][Рисунок 3]

Если вы откроете панель инструментов разработчика и увидите там что-то вроде 
HTML, то на самом деле это — визуальное представление DOM. Мы нашли DOM!

![Хммм. Но выглядит совсем как мой HTML-код][Рисунок 4]

Ну, да, действительно. Помните, DOM формируется из вашего HTML-кода. В самых 
простых случаях визуальное представление DOM будет выглядеть точно так же, как
ваш простой HTML-код.

Но зачастую все совсем не так...

## Когда визуальное представление DOM отличается от HTML-кода?

Например, если в вашем HTML-коде есть ошибки, и браузер исправил их за вас. 
Скажем, у вас есть элемент `<table>`, и вы пропустили необходимый элемент 
`<tbody>`. Браузер просто вставит этот элемент `<tbody>` за вас. Он будет 
присутствовать в DOM, поэтому вы сможете найти его с помощью JavaScript или
стилизовать с помощью CSS, даже если его нет в вашем HTML-коде.

Тем не менее, наиболее вероятная причина в том, что...

## JavaScript может изменять DOM

Представьте, что в вашем HTML-коде есть пустой элемент, примерно вот такой:

	<div id="container"></div>
	
Чуть ниже в коде есть немножко JavaScript'а:

	<script>
		var container = document.getElementById("container");
		container.innerHTML = "Абра-кадабра!";
	</script>
	
Даже если вы не знаете JavaScript, вы можете понять смысл этого фрагмента кода. 
На экране вы увидите *Абра-кадабра!*, потому что пустой `div` был заполнен 
новым содержимым.

Если вы откроете панель инструментов разработчика, чтобы посмотреть на
визуальное представление DOM, то увидите:

	<div id="container">Абра-кадабра!</div>
	
что отличается от оригинального HTML-кода или того, что вы увидите при 
просмотре исходного кода страницы.

## Ajax и шаблонизация

Даже не углубляясь в эту тему, я готов утверждать, что вы понимаете, что DOM
будет очень сильно отличаться от оригинального HTML-кода при использовании AJAX
для получения контента извне и вставки его на страницу. Аналогично происходит
и при загрузке данных и использовании [клиентской шаблонизации][1].

Попробуйте открыть Gmail и посмотреть исходный код страницы. Вы обнаружите 
некоторый набор скриптов и данные для первоначальной загрузки страницы. Совсем
не похоже на интерфейс, который вы видите на экране.

## JavaScript vs. DOM

JavaScript — это язык, понимаемый браузером, с помощью которого в нем делаются 
разные штуки. Все эти штуки происходят именно внутри DOM. Большая часть того, 
что вы бы назвали «JavaScript'овыми штуками», на самом деле является DOM API.

Например, мы можем написать код на JavaScript, который будет следить за
срабатыванием события `mouseenter` на элементе. Этот элемент есть ни что иное, 
как узел DOM-дерева, и к этому узлу мы с помощью DOM-свойства подключаем 
обработчик. Срабатывание события происходит потому, что узел DOM-дерева 
распространяет его.

![Ехал DOM через DOM][Рисунок 5]

Я прощу прощения, если сформулировал что-то неправильно. Но, я надеюсь, вы все 
поняли. DOM — это то, что связывает все воедино, именно внутри DOM все и 
происходит. JavaScript — это просто синтаксис, язык. Он может быть использован 
и вне браузера, где DOM API нет и в помине (обратите внимание на Node.js).

## Эта статья слишком поверхностная и недостаточно заумная для меня

DOM — это «объектная модель документа», и все в таком духе. Я не хотел,
да и недостаточно компетентен, чтобы писать такие статьи. Вот некоторые 
более содержательные материалы:

* W3C: [Что такое объектная модель документа?][2]
* MDN: [Введение - объектная модель документа][3]
* Wikipedia: [Объектная модель документа][4]

[1]: http://css-tricks.com/video-screencasts/127-basics-of-javascript-templating/
[2]: http://www.w3.org/TR/DOM-Level-2-Core/introduction.html
[3]: https://developer.mozilla.org/en-US/docs/DOM/DOM_Reference/Introduction
[4]: http://en.wikipedia.org/wiki/Document_Object_Model

[Рисунок 1]: img/rus/is-html-the-dom.jpg
[Рисунок 2]: img/rus/view-source-no.jpg
[Рисунок 3]: img/rus/devtools-dom.jpg
[Рисунок 4]: img/rus/looks-like-html.jpg
[Рисунок 5]: img/rus/dom-dom-dom-dom.jpg
